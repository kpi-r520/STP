# Современные технологии программирования - 2
## Лабораторная работа №2. Создание инсталляционных пакетов.

### Задание

1. Выбрать схему версионирования и реализовать простой способ смены/отметки версии.
2. Создать инсталляционный скрипт для сборки продукта в инсталляшку.
3. Реализовать сборку инсталляционных скриптов на сервере непрерывной интеграции.
4. Собранные инсталляционные пакеты должны быть доступны в виде артефактов (msi).

### Теоретическая часть

Управление памятью. Указатели/ссылки; стек, неуправляемая куча. Сборщик мусора.
 
### Краткий набор вспомогательных материалов.

**Схема версионирования**

* Желательно использовать [семантическое версионирование][1]
* Изменяется в AssemblyInfo.cs
* Желательно вынести один AssemblyInfo.cs для всех проектов в Solution'е.
* Для отдельных билдов можно использовать * (e.g. 1.0.0.253 = "1.0.0.*")
* Версии желательно отмечать в гите при помощи тегов при изменении минорной/мажорной/ревизии (или по другим принципом при другом способе версионирования)

**Инсталляционный скрипт**

* Необходимо выбрать средство для создания инсталляционных пакетов. Рекомендуемое - [InnoSetup][2]
* Номер версии по скрипту и прочая общая информация должна совпадать с AssemblyInfo.cs (реализуемо при помощи ps скрипта)
* Должен проверять наличие необходимых параметров окружения (установлена ли база/необходимый .net framework и т.п.) и выдавать ошибку в случае отсутствия (с возможной ссылкой для скачивания)
* В случае, если приложение имеет разрядность (32- и 64-разрядное), ожидается написание обоих инсталляционных пакетов
* В случае [уже установленной предыдущей версии][7] приложения она должна быть удалена и заменена новой

**По сборке на билд сервере**

* InnoSetup доступен как [nuget пакет][3] (отчего и удобен)
* Для установки всех данных инсталляционного пакета (версия, название приложения и т.п.) можно использовать powershell скрипт before build
* Реализовать сборку "релизных" версий (например, помечаемых тегом) с конфигурацией Release
* Реализовать [публикацию "релизных" версий на Github Releases] [4]

**Прочее**

* Для ускорения билдов, можно использовать [build cache][5]
* Сборкам инсталляторов стоит происходить только из master веток, хотя обыкновенные билды могут проходить для всех веток
* [Простейший скрипт для определения наличия необходимой версии .net framework][6]


[1]: <http://semver.org/>
[2]: <http://www.jrsoftware.org/isinfo.php>
[3]: <http://www.nuget.org/packages/Tools.InnoSetup/>
[4]: <http://www.appveyor.com/docs/deployment/github>
[5]: <http://www.appveyor.com/docs/build-cache>
[6]: <http://stackoverflow.com/questions/4104011/innosetup-verify-that-net-4-0-is-installed>
[7]: <http://stackoverflow.com/questions/11739317/how-to-detect-old-installation-and-offer-removal>